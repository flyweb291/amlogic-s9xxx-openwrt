# build-openwrt-using-unifreq-scripts.yml è¯¦ç»†ä»‹ç»

## ğŸ“– æ¦‚è¿° / Overview

**æ–‡ä»¶è·¯å¾„**: `.github/workflows/build-openwrt-using-unifreq-scripts.yml`

è¿™æ˜¯ä¸€ä¸ª GitHub Actions å·¥ä½œæµï¼Œç”¨äºä½¿ç”¨ Unifreq çš„æ‰“åŒ…è„šæœ¬å°†ç°æœ‰çš„ OpenWrt rootfs æ–‡ä»¶æ‰“åŒ…æˆé€‚ç”¨äºå„ç§ ARM64 è®¾å¤‡çš„ç³»ç»Ÿé•œåƒã€‚

This is a GitHub Actions workflow that uses Unifreq's packaging scripts to convert existing OpenWrt rootfs files into system images for various ARM64 devices.

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½ / Core Functions

### ä¸»è¦ä½œç”¨ / Main Purpose

**è¿™ä¸ªå·¥ä½œæµåšä»€ä¹ˆï¼Ÿ/ What does this workflow do?**

1. **ä¸‹è½½å·²ç¼–è¯‘çš„ OpenWrt rootfs** - ä»ä»“åº“çš„ Release ä¸­ä¸‹è½½é¢„ç¼–è¯‘çš„ OpenWrt rootfs.tar.gz æ–‡ä»¶
2. **æ‰“åŒ…ä¸ºè®¾å¤‡é•œåƒ** - ä½¿ç”¨ Unifreq çš„è„šæœ¬å°† rootfs æ‰“åŒ…æˆå„ç§ ARM64 è®¾å¤‡å¯ç”¨çš„ç³»ç»Ÿé•œåƒ
3. **æ”¯æŒå¤šè®¾å¤‡** - ä¸€æ¬¡æ€§ä¸ºå¤šä¸ªä¸åŒç¡¬ä»¶è®¾å¤‡ç”Ÿæˆç›¸åº”çš„å›ºä»¶
4. **ä¸Šä¼ åˆ° Release** - å°†ç”Ÿæˆçš„è®¾å¤‡é•œåƒä¸Šä¼ åˆ° GitHub Release ä¾›ç”¨æˆ·ä¸‹è½½

**å…³é”®ç‰¹ç‚¹**:
- âœ… ä¸éœ€è¦ä»æºä»£ç ç¼–è¯‘ OpenWrtï¼ˆèŠ‚çœæ—¶é—´ï¼‰
- âœ… åŸºäºå·²æœ‰çš„ rootfs å¿«é€Ÿç”Ÿæˆå¤šè®¾å¤‡é•œåƒ
- âœ… æ”¯æŒ 50+ ç§ ARM64 è®¾å¤‡ï¼ˆAmlogicã€Rockchipã€Allwinnerï¼‰
- âœ… å¯ä»¥é€‰æ‹©ä¸åŒçš„å†…æ ¸ç‰ˆæœ¬
- âœ… æ„å»ºæ—¶é—´çŸ­ï¼ˆ10-30åˆ†é’Ÿï¼‰

---

## ğŸ”§ å·¥ä½œæµç¨‹è¯¦è§£ / Detailed Workflow

### æ­¥éª¤ 1: ç¯å¢ƒåˆå§‹åŒ– (Initialization)

```yaml
- name: Initialization environment
  run: |
    # æ¸…ç† Docker é•œåƒ
    docker rmi -f $(docker images -q)

    # åˆ é™¤ä¸éœ€è¦çš„è½¯ä»¶å’Œç›®å½•ï¼ˆé‡Šæ”¾ç©ºé—´ï¼‰
    sudo rm -rf /usr/share/dotnet /usr/local/lib/android
    sudo apt-get purge azure-cli ghc* zulu* llvm* ...

    # å®‰è£…ä¾èµ–åŒ…
    sudo apt-get install $(curl -fsSL https://ophub.org/ubuntu2404-make-openwrt-depends)

    # è®¾ç½®æ—¶åŒº
    sudo timedatectl set-timezone "Etc/UTC"
```

**ä½œç”¨**:
- æ¸…ç† GitHub Actions runner ä¸Šä¸éœ€è¦çš„è½¯ä»¶ï¼Œé‡Šæ”¾çº¦ 30-40GB ç©ºé—´
- å®‰è£…æ‰“åŒ… OpenWrt é•œåƒæ‰€éœ€çš„ä¾èµ–åŒ…
- è®¾ç½®æ­£ç¡®çš„æ—¶åŒº

---

### æ­¥éª¤ 2: åˆ›å»ºæ¨¡æ‹Ÿç‰©ç†ç£ç›˜ (Create Simulated Physical Disk)

```yaml
- name: Create simulated physical disk
  run: |
    # è®¡ç®—å¯ç”¨ç©ºé—´
    mnt_size=$(expr $(df -h /mnt | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\..*//') - 1)
    root_size=$(expr $(df -h / | tail -1 | awk '{print $4}' | sed 's/[[:alpha:]]//g' | sed 's/\..*//') - 4)

    # åˆ›å»ºå¤§æ–‡ä»¶ä½œä¸ºè™šæ‹Ÿç£ç›˜
    sudo truncate -s "${mnt_size}"G /mnt/mnt.img
    sudo truncate -s "${root_size}"G /root.img

    # ä½¿ç”¨ LVM åˆ›å»ºé€»è¾‘å·
    sudo losetup /dev/loop6 /mnt/mnt.img
    sudo losetup /dev/loop7 /root.img
    sudo pvcreate /dev/loop6
    sudo pvcreate /dev/loop7
    sudo vgcreate github /dev/loop6 /dev/loop7
    sudo lvcreate -n runner -l 100%FREE github
    sudo mkfs.xfs -f /dev/github/runner

    # æŒ‚è½½åˆ° /builder ç›®å½•
    sudo mkdir -p /builder
    sudo mount /dev/github/runner /builder
    sudo chown -R runner:runner /builder
```

**ä½œç”¨**:
- åˆ©ç”¨ `/mnt` å’Œæ ¹ç›®å½•çš„å¯ç”¨ç©ºé—´åˆ›å»ºä¸€ä¸ªå¤§çš„å·¥ä½œç©ºé—´
- ä½¿ç”¨ LVMï¼ˆé€»è¾‘å·ç®¡ç†ï¼‰æŠ€æœ¯åˆå¹¶å¤šä¸ªç£ç›˜ç©ºé—´
- æä¾›è¶³å¤Ÿçš„ç©ºé—´æ¥å­˜å‚¨ä¸‹è½½çš„ rootfs å’Œç”Ÿæˆçš„é•œåƒæ–‡ä»¶
- æœ€ç»ˆå·¥ä½œç›®å½•: `/builder`

---

### æ­¥éª¤ 3: ä¸‹è½½ OpenWrt rootfs æ–‡ä»¶ (Download OpenWrt rootfs)

```yaml
- name: Download OpenWrt rootfs file
  working-directory: /builder
  run: |
    # åˆ›å»ºä¸‹è½½ç›®å½•
    armsr_tarfile_path="opt/download"
    mkdir -p ${armsr_tarfile_path}

    # ä½¿ç”¨ GitHub API æœç´¢æœ€æ–°çš„ rootfs æ–‡ä»¶
    latest_version=$(curl -s \
        -H "Accept: application/vnd.github+json" \
        -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}" \
        https://api.github.com/repos/${{ github.repository }}/releases?per_page=20 | \
        jq -r --arg RTK "OpenWrt_lede_" \
        --arg BOARD "-rootfs.tar.gz" \
        '[.[] | select(.tag_name | contains($RTK))] |
        map(.assets[] | select(.name | endswith($BOARD))) |
        sort_by(.updated_at) |
        reverse |
        .[0] |
        {data: .updated_at, url: .url, name: .name}')

    # ä¸‹è½½æ–‡ä»¶
    curl -fsSL \
        -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}" \
        -H "Accept: application/octet-stream" \
        "${latest_url}" \
        -o "${armsr_tarfile_path}/${openwrt_filename}"
```

**è¯¦ç»†è¯´æ˜**:

1. **æœç´¢æ¡ä»¶**:
   - åœ¨æœ€è¿‘ 20 ä¸ª Release ä¸­æœç´¢
   - æŸ¥æ‰¾æ ‡ç­¾åŒ…å« `OpenWrt_lede_` çš„ Release
   - æŸ¥æ‰¾æ–‡ä»¶åä»¥ `-rootfs.tar.gz` ç»“å°¾çš„èµ„äº§æ–‡ä»¶

2. **æ’åºæ–¹å¼**:
   - æŒ‰æ›´æ–°æ—¶é—´ (`updated_at`) æ’åº
   - å–æœ€æ–°çš„ä¸€ä¸ªæ–‡ä»¶

3. **ä¸‹è½½æ–¹å¼**:
   - ä½¿ç”¨ GitHub API ä¸‹è½½ï¼ˆéœ€è¦ tokenï¼‰
   - æ·»åŠ  `application/octet-stream` header æ¥ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶

4. **é»˜è®¤æº**:
   - é»˜è®¤ä¸‹è½½åŸºäº **Lean's LEDE** æºç ç¼–è¯‘çš„ rootfs
   - æ–‡ä»¶åç¤ºä¾‹: `openwrt-armsr-armv8-generic-rootfs.tar.gz`

**è¿™ä¸€æ­¥çš„è¾“å‡º**:
- ä¸‹è½½çš„ rootfs æ–‡ä»¶ä¿å­˜åœ¨: `/builder/opt/download/`
- è®¾ç½®ç¯å¢ƒå˜é‡ `build_tag`: `OpenWrt_armv8_{storage}_YYYY.MM`

---

### æ­¥éª¤ 4: æ‰“åŒ… OpenWrt å›ºä»¶ (Package OpenWrt Firmware)

```yaml
- name: Package OpenWrt Firmware
  uses: ophub/flippy-openwrt-actions@main
  env:
    OPENWRT_ARMSR: opt/download/*rootfs.tar.gz
    PACKAGE_SOC: ${{ inputs.openwrt_soc }}
    KERNEL_REPO_URL: ${{ inputs.kernel_repo }}
    KERNEL_VERSION_NAME: ${{ inputs.openwrt_kernel }}
    KERNEL_AUTO_LATEST: ${{ inputs.auto_kernel }}
    OPENWRT_IP: ${{ inputs.openwrt_ip }}
    CUSTOMIZE_RK3399: ${{ inputs.customize_rk3399 }}
    SCRIPT_DIY_PATH: ${{ inputs.script_diy_path }}
    WHOAMI: ${{ inputs.builder_name }}
```

**æ ¸å¿ƒæ­¥éª¤** - è¿™æ˜¯æ•´ä¸ªå·¥ä½œæµçš„å…³é”®ï¼

ä½¿ç”¨ `ophub/flippy-openwrt-actions` è¿™ä¸ª GitHub Actionï¼Œå®ƒä¼šï¼š

1. **è§£å‹ rootfs**: æå– rootfs.tar.gz çš„å†…å®¹
2. **ä¸‹è½½å†…æ ¸**: ä»æŒ‡å®šçš„å†…æ ¸ä»“åº“ï¼ˆé»˜è®¤ `ophub/kernel`ï¼‰ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„å†…æ ¸
3. **å‡†å¤‡è®¾å¤‡æ–‡ä»¶**: æ ¹æ®é€‰æ‹©çš„è®¾å¤‡ç±»å‹å‡†å¤‡ç›¸åº”çš„ DTBï¼ˆè®¾å¤‡æ ‘ï¼‰æ–‡ä»¶
4. **åˆ›å»ºåˆ†åŒºé•œåƒ**: ä¸ºæ¯ä¸ªè®¾å¤‡åˆ›å»ºå¯åŠ¨åˆ†åŒºå’Œæ ¹æ–‡ä»¶ç³»ç»Ÿåˆ†åŒº
5. **å†™å…¥ bootloader**: å†™å…¥ U-Boot ç­‰å¯åŠ¨åŠ è½½å™¨
6. **ç”Ÿæˆé•œåƒæ–‡ä»¶**: æœ€ç»ˆç”Ÿæˆ `.img` æ ¼å¼çš„è®¾å¤‡é•œåƒ

**ç¯å¢ƒå˜é‡è¯´æ˜**:

| å˜é‡ | ä½œç”¨ | ç¤ºä¾‹å€¼ |
|-----|------|-------|
| `OPENWRT_ARMSR` | rootfs æ–‡ä»¶è·¯å¾„ | `opt/download/*rootfs.tar.gz` |
| `PACKAGE_SOC` | ç›®æ ‡è®¾å¤‡ç±»å‹ | `all`, `s905x3`, `rock5b` ç­‰ |
| `KERNEL_REPO_URL` | å†…æ ¸ä¸‹è½½æº | `ophub/kernel` |
| `KERNEL_VERSION_NAME` | å†…æ ¸ç‰ˆæœ¬ | `6.12.y_6.18.y` |
| `KERNEL_AUTO_LATEST` | è‡ªåŠ¨ä½¿ç”¨æœ€æ–°å†…æ ¸ | `true`/`false` |
| `OPENWRT_IP` | é»˜è®¤ IP åœ°å€ | `192.168.1.1` |
| `CUSTOMIZE_RK3399` | è‡ªå®šä¹‰ RK3399 è®¾å¤‡ | DTB æ–‡ä»¶æ˜ å°„ |
| `SCRIPT_DIY_PATH` | è‡ªå®šä¹‰è„šæœ¬è·¯å¾„ | ç”¨äºä¸ªæ€§åŒ–å®šåˆ¶ |
| `WHOAMI` | æ„å»ºè€…ç­¾å | `ophub`, `yourname` ç­‰ |

**æ‰“åŒ…åçš„è¾“å‡º**:
- ç”Ÿæˆçš„é•œåƒä¿å­˜åœ¨ç¯å¢ƒå˜é‡ `PACKAGED_OUTPUTPATH` æŒ‡å®šçš„ç›®å½•
- è®¾ç½®ç¯å¢ƒå˜é‡ `PACKAGED_STATUS=success` è¡¨ç¤ºæ‰“åŒ…æˆåŠŸ

---

### æ­¥éª¤ 5: ä¸Šä¼ åˆ° Release (Upload to Release)

```yaml
- name: Upload OpenWrt Firmware to Release
  uses: ncipollo/release-action@main
  with:
    tag: ${{ env.build_tag }}
    artifacts: ${{ env.PACKAGED_OUTPUTPATH }}/*
    allowUpdates: true
    removeArtifacts: false
    replacesArtifacts: true
    makeLatest: true
```

**ä½œç”¨**:
- åˆ›å»ºæˆ–æ›´æ–° GitHub Release
- Release æ ‡ç­¾: `OpenWrt_armv8_{storage}_YYYY.MM`
  - ä¾‹å¦‚: `OpenWrt_armv8_save_2026.02`
- ä¸Šä¼ æ‰€æœ‰ç”Ÿæˆçš„è®¾å¤‡é•œåƒæ–‡ä»¶
- å¦‚æœæ–‡ä»¶å·²å­˜åœ¨åˆ™æ›¿æ¢
- è®¾ç½®ä¸ºæœ€æ–°ç‰ˆæœ¬ï¼ˆlatestï¼‰

**Release ä¿¡æ¯åŒ…å«**:
- é»˜è®¤ç™»å½•ä¿¡æ¯ï¼ˆIPã€ç”¨æˆ·åã€å¯†ç ï¼‰
- å®‰è£…åˆ° EMMC çš„è¯´æ˜
- æºä»£ç é“¾æ¥
- æ”¯æŒçš„å¹³å°ä¿¡æ¯

---

## âš™ï¸ å¯é…ç½®å‚æ•° / Configurable Parameters

### 1. openwrt_soc (è®¾å¤‡æ¿å‹)

é€‰æ‹©è¦æ‰“åŒ…çš„ç›®æ ‡è®¾å¤‡ç±»å‹ã€‚

**é€‰é¡¹è¯´æ˜**:

| é€‰é¡¹ | è¯´æ˜ | è®¾å¤‡ç¤ºä¾‹ |
|------|------|---------|
| `all` | æ‰€æœ‰æ”¯æŒçš„è®¾å¤‡ | ç”Ÿæˆ 50+ ä¸ªè®¾å¤‡é•œåƒ |
| `s922x_s905x3_s905x2_s912_s905d_s905` | Amlogic å¸¸è§èŠ¯ç‰‡ç»„åˆ | æœºé¡¶ç›’ã€ç”µè§†ç›’å­ |
| `rock5b_h28k_r66s_vplus` | Rockchip å¼€å‘æ¿ç»„åˆ | Rock 5Bã€R66S ç­‰ |
| `s905x3` | å•ä¸ª Amlogic S905X3 | X96 Max+, HK1 Box ç­‰ |
| `rock5b` | å•ä¸ª Rockchip RK3588 | Radxa Rock 5B |
| `r66s` / `r68s` | FastRhino è·¯ç”±å™¨ | R66S/R68S è½¯è·¯ç”± |
| `beikeyun` / `l1pro` | æœ¬åœ°å­˜å‚¨è®¾å¤‡ | è´å£³äº‘ã€ç²’å­äº‘ |
| `rk3399` | Rockchip RK3399 è®¾å¤‡ | NanoPC-T4, Firefly ç­‰ |
| `diy` | è‡ªå®šä¹‰è®¾å¤‡ | éœ€è¦è‡ªå·±é…ç½® DTB |

**Amlogic è®¾å¤‡**:
- s905, s905d, s905x, s905x2, s905x3, s905l, s905l2, s905l3, s905w
- s912, s922x

**Rockchip è®¾å¤‡**:
- rock5b, rock5c, r66s, r68s, h28k, h66k, h68k, h69k, h88k
- photonicat, beikeyun, l1pro

**Allwinner è®¾å¤‡**:
- orangepi-5-plus, orangepi-5b, orangepi-3b, orangepi-zero3

---

### 2. customize_rk3399 (è‡ªå®šä¹‰ RK3399 è®¾å¤‡)

ä¸º RK3399 è®¾å¤‡æŒ‡å®šè‡ªå®šä¹‰ DTB æ–‡ä»¶ã€‚

**æ ¼å¼**: `è®¾å¤‡å:DTBæ–‡ä»¶å/è®¾å¤‡å:DTBæ–‡ä»¶å`

**ç¤ºä¾‹**:
```
tvi3315a:rk3399-tvi3315a.dtb/sw799:rk3399-bozz-sw799.dtb
```

---

### 3. openwrt_ip (é»˜è®¤ IP åœ°å€)

è®¾ç½® OpenWrt çš„é»˜è®¤ IP åœ°å€ã€‚

**é»˜è®¤å€¼**: `192.168.1.1`

**ç”¨é€”**:
- åˆ·å…¥è®¾å¤‡åï¼Œé€šè¿‡è¿™ä¸ª IP è®¿é—® OpenWrt ç®¡ç†ç•Œé¢
- å»ºè®®è®¾ç½®ä¸ºä¸ä¸ä¸»è·¯ç”±å†²çªçš„ IP

---

### 4. kernel_repo (å†…æ ¸ä»“åº“)

æŒ‡å®šä¸‹è½½å†…æ ¸çš„ GitHub ä»“åº“ã€‚

**é€‰é¡¹**:
- `ophub/kernel` (é»˜è®¤) - Ophub ç»´æŠ¤çš„ä¸»çº¿ LTS å†…æ ¸
- `breakingbadboy/OpenWrt` - å¦ä¸€ä¸ªå†…æ ¸æº

**å†…æ ¸è¯´æ˜**:
- æ”¯æŒ Amlogicã€Rockchipã€Allwinner è®¾å¤‡
- æä¾›ç¨³å®šçš„ä¸»çº¿ LTS å†…æ ¸
- å®šæœŸæ›´æ–°è¡¥ä¸å’Œé©±åŠ¨

---

### 5. openwrt_kernel (å†…æ ¸ç‰ˆæœ¬)

é€‰æ‹©è¦ä½¿ç”¨çš„å†…æ ¸ç‰ˆæœ¬ã€‚

**å•ä¸ªç‰ˆæœ¬**:
- `5.10.y` - LTS 5.10 ç³»åˆ—
- `5.15.y` - LTS 5.15 ç³»åˆ—
- `6.1.y` - LTS 6.1 ç³»åˆ—
- `6.6.y` - LTS 6.6 ç³»åˆ—
- `6.12.y` - LTS 6.12 ç³»åˆ—
- `6.18.y` - æœ€æ–° 6.18 ç³»åˆ—

**å¤šä¸ªç‰ˆæœ¬** (ä¼šç”Ÿæˆå¤šå¥—é•œåƒ):
- `6.12.y_6.18.y` (é»˜è®¤) - åŒæ—¶ä½¿ç”¨ 6.12 å’Œ 6.18
- `5.10.y_5.15.y`
- `6.1.y_6.6.y`
- `6.1.y_6.12.y`
- `6.1.y_6.18.y`

**ç‰ˆæœ¬é€‰æ‹©å»ºè®®**:
- **5.15.y**: æœ€ç¨³å®šï¼Œå…¼å®¹æ€§å¥½
- **6.1.y**: æ–°ç‰¹æ€§å’Œç¨³å®šæ€§å¹³è¡¡
- **6.12.y/6.18.y**: æœ€æ–°ç‰¹æ€§ï¼Œæ›´å¥½çš„ç¡¬ä»¶æ”¯æŒ

---

### 6. auto_kernel (è‡ªåŠ¨ä½¿ç”¨æœ€æ–°å†…æ ¸)

æ˜¯å¦è‡ªåŠ¨ä½¿ç”¨æŒ‡å®šç³»åˆ—çš„æœ€æ–°å†…æ ¸ç‰ˆæœ¬ã€‚

**é»˜è®¤å€¼**: `true`

**è¯´æ˜**:
- `true`: ä½¿ç”¨ 6.12.y ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼ˆå¦‚ 6.12.8ï¼‰
- `false`: ä½¿ç”¨å†…æ ¸ä»“åº“ä¸­æœ€æ—©çš„ç‰ˆæœ¬

---

### 7. script_diy_path (è‡ªå®šä¹‰è„šæœ¬è·¯å¾„)

æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰è„šæœ¬ï¼Œåœ¨æ‰“åŒ…è¿‡ç¨‹ä¸­æ‰§è¡Œã€‚

**é»˜è®¤å€¼**: `""` (ç©ºï¼Œä¸æ‰§è¡Œ)

**ç”¨é€”**:
- ä¸ªæ€§åŒ–å®šåˆ¶ç³»ç»Ÿ
- æ·»åŠ æˆ–åˆ é™¤è½¯ä»¶åŒ…
- ä¿®æ”¹é…ç½®æ–‡ä»¶
- è‡ªåŠ¨åŒ–é…ç½®

**ç¤ºä¾‹**:
```bash
# åˆ›å»ºè‡ªå®šä¹‰è„šæœ¬: scripts/my-custom.sh
#!/bin/bash
# åœ¨è¿™é‡Œæ·»åŠ ä½ çš„è‡ªå®šä¹‰å‘½ä»¤
echo "Running custom script..."
opkg update
opkg install nano htop
```

---

### 8. openwrt_storage (é•œåƒå­˜å‚¨ç±»å‹)

é€‰æ‹©ç”Ÿæˆçš„é•œåƒæ–‡ä»¶çš„ä¿ç•™ç­–ç•¥ã€‚

**é€‰é¡¹**:
- `save` (é»˜è®¤) - æ°¸ä¹…ä¿å­˜åœ¨ Release ä¸­
- `temp` - ä¸´æ—¶æ–‡ä»¶ï¼Œä¼šè¢«å®šæœŸæ¸…ç†

**è¯´æ˜**:
- `save`: é€‚åˆç¨³å®šç‰ˆæœ¬ï¼Œé•¿æœŸä¿å­˜ä¾›ç”¨æˆ·ä¸‹è½½
- `temp`: é€‚åˆæµ‹è¯•ç‰ˆæœ¬ï¼Œé¿å…å ç”¨è¿‡å¤šå­˜å‚¨ç©ºé—´

---

### 9. builder_name (æ„å»ºè€…ç­¾å)

åœ¨é•œåƒä¸­æ·»åŠ æ„å»ºè€…çš„æ ‡è¯†ã€‚

**é€‰é¡¹**:
- `ophub` (é»˜è®¤)
- `angel`
- `yourname` (å¯è‡ªå®šä¹‰)

**ä½œç”¨**:
- åœ¨ç³»ç»Ÿä¿¡æ¯ä¸­æ˜¾ç¤ºæ„å»ºè€…
- ç”¨äºåŒºåˆ†ä¸åŒæ¥æºçš„å›ºä»¶

---

## ğŸ“Š ä¸å…¶ä»–å·¥ä½œæµçš„å¯¹æ¯”

### vs. build-openwrt-system-image.yml

| å¯¹æ¯”é¡¹ | unifreq-scripts | system-image |
|-------|----------------|--------------|
| **è¾“å…¥** | å·²ç¼–è¯‘çš„ rootfs | æºä»£ç  |
| **ç¼–è¯‘** | ä¸ç¼–è¯‘ | å®Œæ•´ç¼–è¯‘ |
| **æ—¶é—´** | 10-30åˆ†é’Ÿ | 2-4å°æ—¶ |
| **å®šåˆ¶æ€§** | ä½ï¼ˆåªèƒ½é€‰è®¾å¤‡å’Œå†…æ ¸ï¼‰ | é«˜ï¼ˆå¯æ”¹æºç ï¼‰ |
| **é€‚ç”¨åœºæ™¯** | å¿«é€Ÿç”Ÿæˆå¤šè®¾å¤‡é•œåƒ | è‡ªå®šä¹‰ç¼–è¯‘ |
| **ä¾èµ–** | éœ€è¦å…ˆæœ‰ rootfs | ä¸éœ€è¦ |

### vs. build-openwrt-using-imagebuilder.yml

| å¯¹æ¯”é¡¹ | unifreq-scripts | imagebuilder |
|-------|----------------|--------------|
| **åŸºç¡€** | ä»»ä½• rootfs | å®˜æ–¹ ImageBuilder |
| **ç‰ˆæœ¬** | çµæ´» | å›ºå®šå®˜æ–¹ç‰ˆæœ¬ |
| **è®¾å¤‡æ”¯æŒ** | 50+ ARM64 è®¾å¤‡ | å®˜æ–¹æ”¯æŒè®¾å¤‡ |
| **è‡ªç”±åº¦** | ä¸­ç­‰ | ä¸­ç­‰ |

### vs. build-openwrt-using-releases-files.yml

| å¯¹æ¯”é¡¹ | unifreq-scripts | releases-files |
|-------|----------------|----------------|
| **æœç´¢æ¡ä»¶** | å›ºå®š `OpenWrt_lede_` | å¯é€‰ `openwrt_main/immortalwrt_master/lede_master` |
| **æ‰“åŒ…å·¥å…·** | `flippy-openwrt-actions` | `amlogic-s9xxx-openwrt` |
| **åŠŸèƒ½** | åŸºæœ¬ç›¸åŒ | åŸºæœ¬ç›¸åŒ |

**ä¸»è¦åŒºåˆ«**: `releases-files` å¯ä»¥é€‰æ‹©ä¸åŒæºç åˆ†æ”¯çš„ rootfsï¼Œè€Œ `unifreq-scripts` å›ºå®šä½¿ç”¨ LEDE çš„ rootfsã€‚

---

## ğŸ¬ å®Œæ•´æ‰§è¡Œæµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·è§¦å‘å·¥ä½œæµ (workflow_dispatch)        â”‚
â”‚  æˆ–é€šè¿‡ API (repository_dispatch)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: Checkout ä»£ç ä»“åº“                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2: åˆå§‹åŒ–ç¯å¢ƒ                       â”‚
â”‚  - æ¸…ç†ä¸éœ€è¦çš„è½¯ä»¶                        â”‚
â”‚  - å®‰è£…ä¾èµ–åŒ…                             â”‚
â”‚  - è®¾ç½®æ—¶åŒº                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 3: åˆ›å»ºæ¨¡æ‹Ÿç‰©ç†ç£ç›˜                  â”‚
â”‚  - ä½¿ç”¨ LVM åˆ›å»ºå¤§å·¥ä½œç©ºé—´                 â”‚
â”‚  - æŒ‚è½½åˆ° /builder                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 4: ä¸‹è½½ OpenWrt rootfs              â”‚
â”‚  - ä» Release æœç´¢æœ€æ–°çš„ rootfs.tar.gz    â”‚
â”‚  - ä¸‹è½½åˆ° /builder/opt/download/          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 5: æ‰“åŒ… OpenWrt å›ºä»¶                â”‚
â”‚  ä½¿ç”¨ ophub/flippy-openwrt-actions:       â”‚
â”‚  1. è§£å‹ rootfs                           â”‚
â”‚  2. ä¸‹è½½æŒ‡å®šç‰ˆæœ¬å†…æ ¸                       â”‚
â”‚  3. å‡†å¤‡è®¾å¤‡ DTB æ–‡ä»¶                      â”‚
â”‚  4. åˆ›å»ºåˆ†åŒºå’Œæ–‡ä»¶ç³»ç»Ÿ                     â”‚
â”‚  5. å†™å…¥ bootloader                       â”‚
â”‚  6. ç”Ÿæˆè®¾å¤‡é•œåƒ (.img)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 6: ä¸Šä¼ åˆ° GitHub Release            â”‚
â”‚  - åˆ›å»º/æ›´æ–° Release                      â”‚
â”‚  - ä¸Šä¼ æ‰€æœ‰è®¾å¤‡é•œåƒ                        â”‚
â”‚  - Tag: OpenWrt_armv8_{storage}_YYYY.MM  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ ä½¿ç”¨åœºæ™¯å’Œæœ€ä½³å®è·µ

### åœºæ™¯ 1: é¦–æ¬¡ä½¿ç”¨

**å‰ææ¡ä»¶**: éœ€è¦å…ˆè¿è¡Œ `build-openwrt-system-image.yml` ç¼–è¯‘å‡º rootfs

**æ­¥éª¤**:
1. è¿è¡Œ `build-openwrt-system-image.yml` ç¼–è¯‘ OpenWrtï¼ˆç­‰å¾… 2-4 å°æ—¶ï¼‰
2. ç¼–è¯‘å®Œæˆåï¼ŒRelease ä¸­ä¼šæœ‰ rootfs.tar.gz
3. è¿è¡Œ `build-openwrt-using-unifreq-scripts.yml`
4. é€‰æ‹©ä½ çš„è®¾å¤‡ç±»å‹ï¼ˆå¦‚ `s905x3` æˆ– `rock5b`ï¼‰
5. ç­‰å¾… 10-30 åˆ†é’Ÿ
6. ä» Release ä¸‹è½½é€‚åˆä½ è®¾å¤‡çš„é•œåƒ

### åœºæ™¯ 2: æ›´æ–°å†…æ ¸ç‰ˆæœ¬

å¦‚æœä½ å·²ç»æœ‰ rootfsï¼Œåªæƒ³æ¢ä¸ªå†…æ ¸ç‰ˆæœ¬ï¼š

**æ­¥éª¤**:
1. è¿è¡Œ `build-openwrt-using-unifreq-scripts.yml`
2. ä¿®æ”¹ `openwrt_kernel` å‚æ•°ï¼ˆå¦‚ä» `6.12.y` æ”¹ä¸º `6.18.y`ï¼‰
3. ä¿æŒå…¶ä»–å‚æ•°ä¸å˜
4. å¿«é€Ÿç”Ÿæˆä½¿ç”¨æ–°å†…æ ¸çš„é•œåƒ

### åœºæ™¯ 3: ä¸ºå¤šä¸ªè®¾å¤‡æ‰“åŒ…

å¦‚æœä½ æƒ³ä¸ºå¤šä¸ªä¸åŒçš„è®¾å¤‡ç”Ÿæˆé•œåƒï¼š

**æ–¹æ³• 1**: é€‰æ‹© `all`
- ä¸€æ¬¡æ€§ç”Ÿæˆæ‰€æœ‰æ”¯æŒè®¾å¤‡çš„é•œåƒ
- æ—¶é—´è¾ƒé•¿ï¼ˆ30-60 åˆ†é’Ÿï¼‰
- ç”Ÿæˆ 50+ ä¸ªé•œåƒæ–‡ä»¶

**æ–¹æ³• 2**: å¤šæ¬¡è¿è¡Œï¼Œæ¯æ¬¡é€‰æ‹©ä¸åŒè®¾å¤‡
- ç¬¬ä¸€æ¬¡: `openwrt_soc = s905x3`
- ç¬¬äºŒæ¬¡: `openwrt_soc = rock5b`
- ç¬¬ä¸‰æ¬¡: `openwrt_soc = r66s`
- æ¯æ¬¡åªç”Ÿæˆç‰¹å®šè®¾å¤‡çš„é•œåƒï¼Œé€Ÿåº¦å¿«

### åœºæ™¯ 4: è‡ªå®šä¹‰é…ç½®

å¦‚æœéœ€è¦æ·»åŠ è‡ªå·±çš„é…ç½®æˆ–è„šæœ¬ï¼š

**æ­¥éª¤**:
1. åœ¨ä»“åº“ä¸­åˆ›å»ºè‡ªå®šä¹‰è„šæœ¬æ–‡ä»¶ï¼Œå¦‚ `config/custom/my-script.sh`
2. åœ¨è„šæœ¬ä¸­æ·»åŠ ä½ çš„å®šåˆ¶å†…å®¹
3. è¿è¡Œå·¥ä½œæµæ—¶ï¼Œè®¾ç½® `script_diy_path = config/custom/my-script.sh`
4. å·¥ä½œæµä¼šåœ¨æ‰“åŒ…è¿‡ç¨‹ä¸­æ‰§è¡Œä½ çš„è„šæœ¬

---

## ğŸ” æ•…éšœæ’æŸ¥ / Troubleshooting

### é—®é¢˜ 1: "Invalid OpenWrt rootfs download address"

**åŸå› **: Release ä¸­æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ rootfs æ–‡ä»¶

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥æ˜¯å¦å·²ç»è¿è¡Œè¿‡ `build-openwrt-system-image.yml`
2. ç¡®è®¤ Release ä¸­æœ‰åŒ…å« `OpenWrt_lede_` æ ‡ç­¾çš„å‘å¸ƒ
3. ç¡®è®¤æœ‰ `-rootfs.tar.gz` ç»“å°¾çš„æ–‡ä»¶

### é—®é¢˜ 2: æ‰“åŒ…å¤±è´¥

**åŸå› **: å¯èƒ½æ˜¯å†…æ ¸ä¸‹è½½å¤±è´¥æˆ–è®¾å¤‡é…ç½®é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ `kernel_repo` è®¾ç½®æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤æ‰€é€‰å†…æ ¸ç‰ˆæœ¬åœ¨ä»“åº“ä¸­å­˜åœ¨
3. æŸ¥çœ‹å·¥ä½œæµæ—¥å¿—ä¸­çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯

### é—®é¢˜ 3: ç”Ÿæˆçš„é•œåƒæ— æ³•å¯åŠ¨

**åŸå› **: è®¾å¤‡ç±»å‹é€‰æ‹©é”™è¯¯æˆ–å†…æ ¸ä¸å…¼å®¹

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤é€‰æ‹©äº†æ­£ç¡®çš„è®¾å¤‡å‹å·
2. å°è¯•ä½¿ç”¨ä¸åŒçš„å†…æ ¸ç‰ˆæœ¬
3. æŸ¥çœ‹è®¾å¤‡æ˜¯å¦åœ¨æ”¯æŒåˆ—è¡¨ä¸­
4. æ£€æŸ¥ DTB æ–‡ä»¶æ˜¯å¦æ­£ç¡®

---

## ğŸ“š ç›¸å…³èµ„æº / Related Resources

### é¡¹ç›®é“¾æ¥

- **Unifreq çš„æ‰“åŒ…è„šæœ¬**: https://github.com/unifreq/openwrt_packit
- **Flippy OpenWrt Actions**: https://github.com/ophub/flippy-openwrt-actions
- **Ophub å†…æ ¸ä»“åº“**: https://github.com/ophub/kernel
- **Lean's LEDE**: https://github.com/coolsnowwolf/lede

### è®¾å¤‡æ”¯æŒ

- **Amlogic è®¾å¤‡**: S905/S905D/S905X/S912/S922X/S905X2/S905X3 ç­‰
- **Rockchip è®¾å¤‡**: RK3328/RK3399/RK3568/RK3588 ç­‰
- **Allwinner è®¾å¤‡**: H6/H616/H618 ç­‰

### æ–‡æ¡£

- OpenWrt å®˜æ–¹æ–‡æ¡£: https://openwrt.org/docs/start
- åˆ·æœºæŒ‡å—: å‚è§ä»“åº“ README.md
- å¸¸è§é—®é¢˜: å‚è§ä»“åº“ Issues

---

## ğŸ“ æ€»ç»“ / Summary

### æ ¸å¿ƒè¦ç‚¹

1. **è¿™ä¸ªå·¥ä½œæµä¸ç¼–è¯‘ OpenWrt**ï¼Œè€Œæ˜¯åˆ©ç”¨ç°æˆçš„ rootfs æ‰“åŒ…
2. **é€Ÿåº¦å¿«**ï¼Œ10-30 åˆ†é’Ÿå³å¯å®Œæˆ
3. **æ”¯æŒå¤šè®¾å¤‡**ï¼Œä¸€æ¬¡å¯ä»¥ä¸º 50+ ç§è®¾å¤‡ç”Ÿæˆé•œåƒ
4. **çµæ´»çš„å†…æ ¸é€‰æ‹©**ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„å†…æ ¸
5. **ä¾èµ–å…¶ä»–å·¥ä½œæµ**ï¼Œéœ€è¦å…ˆæœ‰ rootfs æ–‡ä»¶

### é€‚åˆäººç¾¤

âœ… å·²æœ‰ç¼–è¯‘å¥½çš„ rootfsï¼Œæƒ³å¿«é€Ÿç”Ÿæˆè®¾å¤‡é•œåƒ
âœ… éœ€è¦ä¸ºå¤šä¸ªè®¾å¤‡ç”Ÿæˆç›¸åŒç³»ç»Ÿçš„å›ºä»¶
âœ… æƒ³æµ‹è¯•ä¸åŒå†…æ ¸ç‰ˆæœ¬
âœ… ä¸éœ€è¦ä¿®æ”¹ OpenWrt æºä»£ç 
âœ… è¿½æ±‚å¿«é€Ÿéƒ¨ç½²

### ä¸é€‚åˆäººç¾¤

âŒ éœ€è¦ä»æºä»£ç å®Œå…¨è‡ªå®šä¹‰ç¼–è¯‘
âŒ éœ€è¦æ·»åŠ æˆ–ä¿®æ”¹ OpenWrt è½¯ä»¶åŒ…
âŒ ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œè¿˜æ²¡æœ‰ rootfs æ–‡ä»¶
âŒ éœ€è¦ç‰¹æ®Šçš„ç¼–è¯‘é€‰é¡¹

---

**æœ€åæ›´æ–°**: 2026-02-19
**å·¥ä½œæµç‰ˆæœ¬**: åŸºäºå½“å‰ä»“åº“çš„æœ€æ–°ç‰ˆæœ¬
